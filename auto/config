#!/bin/bash

set -e

lb config noauto \
    --architectures amd64 \
    --mode debian \
    --distribution bookworm \
    --archive-areas "main contrib non-free non-free-firmware" \
    --mirror-bootstrap https://mirrors.ustc.edu.cn/debian \
    --mirror-chroot https://mirrors.ustc.edu.cn/debian \
    --mirror-chroot-security https://mirrors.ustc.edu.cn/debian-security \
    --mirror-binary https://mirrors.ustc.edu.cn/debian \
    --mirror-binary-security https://mirrors.ustc.edu.cn/debian-security \
    --mirror-debian-installer https://mirrors.ustc.edu.cn/debian \
    --cache-packages true \
    --binary-filesystem ext4 \
    --binary-images iso-hybrid \
    --iso-publisher 'DevOS; https://gitee.com/jaysinco/devos; jaysinco@163.com' \
    --iso-volume 'DevOS $(date +%Y%m%d-%H:%M)' \
    --bootappend-live "boot=live components quiet splash hostname=sinco-dev username=sinco" \
    --bootloader "syslinux,grub-efi" \
    --linux-packages linux-image \
    --linux-flavours amd64 \
    --apt-indices false \
    --apt-recommends true \
    --apt-secure false \
    --security true \
    --updates false \
    --system live \
    "${@}"
